      - name: Write pubspec.yaml
        run: |
          cat <<'EOF' > pubspec.yaml
name: app_abou_alnour
description: MSN Care Tracker
publish_to: "none"

environment:
  sdk: ">=3.3.0 <4.0.0"

dependencies:
  flutter:
    sdk: flutter
  http: ^1.2.2
  intl: ^0.19.0
  flutter_map: ^6.1.0
  latlong2: ^0.9.1
  url_launcher: ^6.3.0

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^4.0.0

flutter:
  uses-material-design: true
EOF
      - name: Ensure INTERNET permission
        run: |
          MANIFEST="android/app/src/main/AndroidManifest.xml"
          if ! grep -q 'android.permission.INTERNET' "$MANIFEST"; then
            sed -i '0,/<application/{s//<uses-permission android:name="android.permission.INTERNET"\/>\n&/}' "$MANIFEST"
          fi
